@using SYJMA.Umbraco.Controllers;
@inherits Umbraco.Web.Mvc.UmbracoViewPage<SYJMA.Umbraco.Models.SchoolModel>

<link href="~/Content/fullcalendar.css" rel="stylesheet" />
<link href="~/Content/fullcalendar.print.css" rel="stylesheet" media="print" />
<script src="~/Scripts/moment.min.js"></script>
<script src="~/Scripts/fullcalendar.min.js"></script>

@*<script src="~/Scripts/calendar.control.js"></script>*@
<link href="~/Content/calendar.control.css" rel="stylesheet" />

<script>

    $(document).ready(function () {

        addEvents("1");
        $('#calendarForm input').on('change', function () {
            addEvents($('input[name=Program]:checked', '#calendarForm').val());
        });

        $('#calendar').fullCalendar({
            header: {
                left: 'prev',
                center: 'title',
                right: 'next'
            },
            defaultView: 'agendaWeek',
            defaultDate: new Date(), // Selected date
            editable: true,
            eventLimit: true, // allow "more" link when too many events
            allDaySlot: false,
            minTime: '9:00',
            maxTime: '17:00',
            firstDay: 1,
            weekends: false,
            contentHeight: 200,
            timezone: 'local',
            titleFormat: 'D MMM YYYY',
            eventStartEditable: false,
            eventDurationEditable: false,
            eventClick: function (calEvent, jsEvent, view) {
                alert('Event: ' + calEvent.title + ' \nTime: ' + calEvent.start.toString('dd-mm-yyyy') + '\nID: ' + calEvent.id);
            }

        });
    });

    function addEvents(url) {
        removeEvents();
        $.ajax({
            type: 'POST',
            url: '/umbraco/Surface/CalendarForm/GetJsonData?eventName=' + url,
            success: function (result) {
                $('#calendar').fullCalendar('addEventSource', result);
            }
        });
    }

    function removeEvents() {
        $('#calendar').fullCalendar('removeEvents')
    }

</script>

@using (Html.BeginUmbracoForm<CalendarFormController>("PostCalendarForm_School", null, new Dictionary<string, object> { { "id", "calendarForm" } }))
{
    <div class="row">
        <div class="form-group col-md-4">
            <b>Programs </b>
            <br />
            <ul class="radio">
                @foreach (var item in Model.ProgramList)
                {
                    <li>
                        <label>@Html.RadioButtonFor(m => m.Program, item.Value)@item.Value</label>
                    </li>
                }
            </ul>
        </div>
        <div id="calendar" class="form-group col-md-8">
            @* Display Calendar here *@

        </div>
    </div>
}
